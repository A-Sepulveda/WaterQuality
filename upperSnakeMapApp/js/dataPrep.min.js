function dataPrep(){$.each(results,function(t,e){var a=e.siteId,s=e.date;resultsData[a]?(resultsData[a].pH[s]=e.phMean,resultsData[a].calcium[s]=e.caMean,resultsData[a].temperature[s]=e.tempMean):(resultsData[a]={pH:{},calcium:{},temperature:{}},resultsData[a].pH[s]=e.phMean,resultsData[a].calcium[s]=e.caMean,resultsData[a].temperature[s]=e.tempMean)}),$.each(Object.keys(resultsData),function(t,e){phDatesSorted=Object.keys(resultsData[e].pH).sort(date_sort_desc),calciumDatesSorted=Object.keys(resultsData[e].calcium).sort(date_sort_desc),temperatureDatesSorted=Object.keys(resultsData[e].temperature).sort(date_sort_desc),resultsData[e].pH.sortedDates=phDatesSorted,resultsData[e].calcium.sortedDates=calciumDatesSorted,resultsData[e].temperature.sortedDates=temperatureDatesSorted}),addToMappedSites()}function addToMappedSites(){$.each(siteLocations.features,function(t,e){thisSiteId=e.properties.MonitoringLocationIdentifier,siteLocations.features[t].properties.pH=resultsData[thisSiteId].pH,siteLocations.features[t].properties.calcium=resultsData[thisSiteId].calcium,siteLocations.features[t].properties.temperature=resultsData[thisSiteId].temperature}),mapInits()}var resultsData={},date_sort_desc=function(t,e){return new Date(t)>new Date(e)?-1:new Date(t)<new Date(e)?1:0};